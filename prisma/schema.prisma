generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model admin {
  usuario_id Int        @id @default(autoincrement())
  usuario    usuario    @relation(fields: [usuario_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fkey_usuario_admin")
  resposta   resposta[]
}

model pergunta {
  id          Int        @id @default(autoincrement())
  texto       String     @db.VarChar
  usuario_id  Int        @default(autoincrement())
  sala_codigo Int        @default(autoincrement())
  sala        sala       @relation(fields: [sala_codigo], references: [codigo], onDelete: NoAction, onUpdate: NoAction, map: "fkey_sala_pergunta")
  usuario     usuario    @relation(fields: [usuario_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fkey_usuario_pergunta")
  resposta    resposta[]
}

model resposta {
  id          Int      @id @default(autoincrement())
  texto       String   @db.VarChar
  pergunta_id Int      @default(autoincrement())
  admin_id    Int      @default(autoincrement())
  admin       admin    @relation(fields: [admin_id], references: [usuario_id], onDelete: NoAction, onUpdate: NoAction, map: "fkey_admin_resposta")
  pergunta    pergunta @relation(fields: [pergunta_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fkey_pergunta_resposta")
}

model sala {
  codigo        Int             @id //@default(autoincrement())
  assunto       String          @db.VarChar
  inicio_em     DateTime        @db.Timestamp(6)
  fim_em        DateTime?       @db.Timestamp(6)
  status        Boolean?        @default(true)
  admin_id      Int             @default(autoincrement())
  usuario       usuario         @relation(fields: [admin_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fkey_admin_sala")
  pergunta      pergunta[]
  sala_usuarios sala_usuarios[]
}

model sala_usuarios {
  sala_codigo Int     @default(autoincrement())
  usuario_id  Int     @default(autoincrement())
  sala        sala    @relation(fields: [sala_codigo], references: [codigo], onDelete: NoAction, onUpdate: NoAction, map: "fkey_sala_sala_usuario")
  usuario     usuario @relation(fields: [usuario_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fkey_usuario_sala_usuario")

  @@id([sala_codigo, usuario_id])
}

model usuario {
  id            Int             @id @default(autoincrement())
  nome          String          @db.VarChar
  email         String          @unique(map: "ukey_usuario_email") @db.VarChar
  senha         String          @db.VarChar
  admin         admin?
  pergunta      pergunta[]
  sala          sala[]
  sala_usuarios sala_usuarios[]
}
